<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Write simulated data into formats used by standard GWAS software — writeStandardOutput • PhenotypeSimulator</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Write simulated data into formats used by standard GWAS software — writeStandardOutput" />

<meta property="og:description" content="writeStandardOutput can write genotypes and phenotypes as well as possible
covariates and kinship matrices into a number of formats for standard GWAS 
software: plink, snptest, bimbam, gemma, limmbo. For more information on the 
different file formats see External formats." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhenotypeSimulator</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/PhenotypeSimulator.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Sample-scripts-external-genotype-simulation.html">Genotype simulation supported by *PhenotypeSimulator*</a>
    </li>
    <li>
      <a href="../articles/Simulation-and-LinearModel.html">Application of PhenotypeSimulator for a power analysis study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HannahVMeyer/PhenotypeSimulator">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Write simulated data into formats used by standard GWAS software</h1>
    <small class="dont-index">Source: <a href='https://github.com/HannahVMeyer/PhenotypeSimulator/blob/master/R/outputFunctions.R'><code>R/outputFunctions.R</code></a></small>
    <div class="hidden name"><code>writeStandardOutput.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>writeStandardOutput can write genotypes and phenotypes as well as possible
covariates and kinship matrices into a number of formats for standard GWAS 
software: plink, snptest, bimbam, gemma, limmbo. For more information on the 
different file formats see <em>External formats</em>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>writeStandardOutput</span>(<span class='no'>directory</span>, <span class='kw'>phenotypes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>genotypes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>additionalPhenotypes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>covariates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kinship</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>eval_kinship</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>evec_kinship</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>id_samples</span>, <span class='no'>id_snps</span>,
  <span class='no'>id_phenos</span>, <span class='kw'>outstring</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>standardInput_samples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>standardInput_genotypes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>format</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>intercept_gemma</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nameAdditional</span> <span class='kw'>=</span> <span class='st'>"_nonLinear"</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>directory</th>
      <td><p>Absolute path (no tilde expansion) to parent directory 
[string] where the data should be saved [needs user writing permission]</p></td>
    </tr>
    <tr>
      <th>phenotypes</th>
      <td><p>[NrSamples x NrTrait] Data.frame/matrix of phenotypes 
[doubles].</p></td>
    </tr>
    <tr>
      <th>genotypes</th>
      <td><p>[NrSamples x NrSNP] Data.frame/matrix of genotypes 
[integers]/[doubles].</p></td>
    </tr>
    <tr>
      <th>additionalPhenotypes</th>
      <td><p>[NrSamples x NrTrait] Data.frame/matrix of 
additional phenotypes (for instance non-linearly tranformed orginal</p></td>
    </tr>
    <tr>
      <th>covariates</th>
      <td><p>[NrSamples x NrCovariates] Data.frame/matrix of covariates
[integers]/[doubles].</p></td>
    </tr>
    <tr>
      <th>kinship</th>
      <td><p>[NrSamples x NrSamples] Data.frame/matrix of kinship estimates
[doubles].</p></td>
    </tr>
    <tr>
      <th>eval_kinship</th>
      <td><p>[NrSamples] vector with eigenvalues of kinship matrix
[doubles].</p></td>
    </tr>
    <tr>
      <th>evec_kinship</th>
      <td><p>[NrSamples x NrSamples] Data.frame/matrix with
eigenvectors of kinship matrix [doubles].</p></td>
    </tr>
    <tr>
      <th>id_samples</th>
      <td><p>Vector of [NrSamples] sample IDs [string] of simulated 
phenotypes, genotypes and covariates.</p></td>
    </tr>
    <tr>
      <th>id_snps</th>
      <td><p>Vector of [NrSNPs] SNP IDs [string] of (simulated) 
genotypes.</p></td>
    </tr>
    <tr>
      <th>id_phenos</th>
      <td><p>Vector of [NrTraits] phenotype IDs [string] of 
simulated phenotypes.</p></td>
    </tr>
    <tr>
      <th>outstring</th>
      <td><p>(optional) Name [string] of subdirectory (in relation to 
directory) to save set-up independent simulation results.</p></td>
    </tr>
    <tr>
      <th>standardInput_samples</th>
      <td><p>(optional) Data.frame of sample information 
obtained when genotypes were read from plink, oxgen or genome file.</p></td>
    </tr>
    <tr>
      <th>standardInput_genotypes</th>
      <td><p>(optional) Data.frame of genotypes obtained 
when reading genotypes from plink, oxgen, or genome file.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>Vector of name(s) [string] of file formats, options are: 
"plink", "snptest", "gemma", "bimbam", "delim". For details on the file 
formats see <em>External formats</em>.</p></td>
    </tr>
    <tr>
      <th>intercept_gemma</th>
      <td><p>[boolean] When modeling an intercept term in gemma, a 
column of 1's have to be appended to the covariate files. Set intercept_gemma
to TRUE to include a column of 1's in the output.</p></td>
    </tr>
    <tr>
      <th>nameAdditional</th>
      <td><p>name [string] of additonal phenotypes to be appended to 
filename.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>[boolean]; If TRUE, progress info is printed to standard out</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="external-formats"><a class="anchor" href="#external-formats"></a>External formats</h2>

    
    <ul>
<li><p>plink format: consists of three files, .bed, .bim and .fam. 
From <a href='https://www.cog-genomics.org/plink/1.9/formats'>https://www.cog-genomics.org/plink/1.9/formats</a>:  The .bed 
files contain the  primary representation of genotype calls at biallelic 
variants in a binary format. The .bim is a text file with no header 
line, and one line  per variant with the following six fields: i) Chromosome 
code (either an integer, or 'X'/'Y'/'XY'/'MT'; '0' indicates unknown) or 
name, ii) Variant identifier, iii) Position in morgans or centimorgans (safe 
to use dummy value of '0'), iv) Base-pair coordinate (normally 1-based, but 
0 ok; limited to 231-2), v) Allele 1 (corresponding to clear bits in .bed; 
usually minor), vi) Allele 2 (corresponding to set bits in .bed; usually 
major). The .fam file is a text file with no header line, and one line per 
sample with the following six fields: i) Family ID ('FID'), ii), Within-
family ID ('IID'; cannot be '0'), iii) Within-family ID of father ('0' if 
father isn't in dataset, iv) within-family ID of mother ('0' if mother isn't 
in dataset), v) sex code ('1' = male, '2' = female, '0' = unknown), vi) 
Phenotype value ('1' = control, '2' = case, '-9'/'0'/non-numeric = missing 
data if case/control)</p></li>
<li><p>snptest format: consists of two files, the genotype file ending in .gen 
(genotypes_snptest.gen) and the sample file ending in .sample 
(Ysim_snptest.sample). From
 <a href='http://www.stats.ox.ac.uk/~marchini/software/gwas/file_format.html'>http://www.stats.ox.ac.uk/~marchini/software/gwas/file_format.html</a>:
The genotype file stores data on a one-line-per-SNP format. The first 5 
entries of each line should be the SNP ID, RS ID of the SNP, base-pair 
position of the SNP, the allele coded A and the allele coded B. The SNP ID 
can be used to denote the chromosome number of each SNP. The next three 
numbers on the line should be the probabilities of the three genotypes AA, 
AB and BB at the SNP for the first individual in the cohort. The next three 
numbers should be the genotype probabilities for the second individual in the 
cohort. The next three numbers are for the third individual and so on. The 
order of individuals in the genotype file should match the order of the 
individuals in the sample file. The sample file has three parts (a) a header 
line detailing the names of the columns in the file, (b) a line detailing the 
types of variables stored in each column, and (c) a line for each individual 
detailing the information for that individual. 
a) The header line needs a minimum of three entries. The first three entries 
should always be ID_1, ID_2 and missing. They denote that the first three 
columns contain the first ID, second ID and missing data proportion of each 
individual. Additional entries on this line should be the names of covariates 
or phenotypes that are included in the file. In the above example, there are 
4 covariates named cov_1, cov_2, cov_3, cov_4, a continuous phenotype named 
pheno1 and a binary phenotype named bin1. All phenotypes should appear after 
the covariates in this file. b) The second line (the variable type line) 
details the type of variables included in each column. The first three 
entries of this line should be set to 0. Subsequent entries in this line for 
covariates and phenotypes should be specified by the following rules: D for
Discrete covariates (coded using positive integers), C for Continuous 
covariates, P for Continuous Phenotype, B for Binary Phenotype (0 = Controls, 
1 = Cases). c) Individual information: one line for each individual 
containing the information specified by the entries of the header line.
Entries of the sample file are separated by spaces.</p></li>
<li><p>bimbam format: consists of a) a simple, tab-separated phenotype file 
without sample or phenotype header/index (Ysim_bimbam.txt) and b) the mean 
genotype file format which is a single file, without information on individuals: 
(genotypes.bimbam). From <a href='http://www.haplotype.org/bimbam.html'>http://www.haplotype.org/bimbam.html</a>: 
The first column of the mean genotype files is the SNP ID, the second and 
third columns are allele types with minor allele first. The rest columns are 
the mean genotypes of different individuals – numbers between 0 and 2 that 
represents the (posterior) mean genotype, or dosage of the minor allele.</p></li>
<li><p>gemma format: consists of a) a simple, tab-separated phenotype file 
without sample or phenotype header/index (Ysim_gemma.txt) and b) the mean 
genotype file format which is a single file, without information on 
individuals(genotypes.gemma); a) and b) both the same as above for bimbam 
format). In addition and if applicable, c) a kinship file (kinship_gemma.txt)
and d) covariate file (Covs_gemma.txt). From 
<a href='http://www.xzlab.org/software/GEMMAmanual.pdf'>http://www.xzlab.org/software/GEMMAmanual.pdf</a>: The kinship file 
contains a NrSample × NrSample matrix, where each row and each column 
corresponds to individuals in the same order as in the mean genotype file, 
and ith row and jth column is a number indicating the relatedness value 
between ith and jth individuals. The covariates file has the same format as 
the phenotype file dsecribed above and must contain a column of 1’s if one 
wants to include an intercept term (set parameter intercept_gemma=TRUE).</p></li>
<li><p>limmbo format: consists of a) a comma-separated phenotype file 
without sample IDs as index and phenotype IDs as header (Ysim_limmbo.csv),
b) the mean genotype file format with one genetic variant per line. The
first column contains the variant ID, column 2-N+1 contain the genotype code
(numbers between 0 and 2 that represent the (posterior) mean genotype/dosage
of the minor allele) for N samples, c)  a kinship file (kinship_limmbo.csv)
and d) covariate file (covs_limmbo.csv). From</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='readStandardGenotypes.html'>readStandardGenotypes</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>simulation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='runSimulation.html'>runSimulation</a></span>(<span class='kw'>N</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>P</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>genVar</span><span class='kw'>=</span><span class='fl'>0.4</span>, <span class='kw'>h2s</span><span class='kw'>=</span><span class='fl'>0.2</span>, <span class='kw'>phi</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>genotypes</span> <span class='kw'>&lt;-</span> <span class='no'>simulation</span>$<span class='no'>rawComponents</span>$<span class='no'>genotypes</span>
<span class='no'>kinship</span> <span class='kw'>&lt;-</span>  <span class='no'>simulation</span>$<span class='no'>rawComponents</span>$<span class='no'>kinship</span>
<span class='no'>phenotypes</span> <span class='kw'>&lt;-</span> <span class='no'>simulation</span>$<span class='no'>phenoComponents</span>$<span class='no'>Y</span></div><span class='co'># NOT RUN {</span>
<span class='co'># Save in plink format (.bed, .bim, .fam, Y_sim_plink.txt)</span>
<span class='fu'>writeStandardOutput</span>(<span class='kw'>directory</span><span class='kw'>=</span><span class='fu'>tempdir</span>(),
<span class='kw'>genotypes</span><span class='kw'>=</span><span class='no'>genotypes</span>$<span class='no'>genotypes</span>, <span class='kw'>phenotypes</span><span class='kw'>=</span><span class='no'>phenotypes</span>,
<span class='kw'>id_samples</span> <span class='kw'>=</span> <span class='no'>genotypes</span>$<span class='no'>id_samples</span>, <span class='kw'>id_snps</span> <span class='kw'>=</span> <span class='no'>genotypes</span>$<span class='no'>id_snps</span>,
<span class='kw'>id_phenos</span> <span class='kw'>=</span> <span class='fu'>colnames</span>(<span class='no'>phenotypes</span>), <span class='kw'>format</span><span class='kw'>=</span><span class='st'>"plink"</span>)

<span class='co'># Save in gemma and snptest format</span>
<span class='fu'>writeStandardOutput</span>(<span class='kw'>directory</span><span class='kw'>=</span><span class='fu'>tempdir</span>(),
<span class='kw'>genotypes</span><span class='kw'>=</span><span class='no'>genotypes</span>$<span class='no'>genotypes</span>, <span class='kw'>phenotypes</span><span class='kw'>=</span><span class='no'>phenotypes</span>,
<span class='kw'>id_samples</span> <span class='kw'>=</span> <span class='no'>genotypes</span>$<span class='no'>id_samples</span>, <span class='kw'>id_snps</span> <span class='kw'>=</span> <span class='no'>genotypes</span>$<span class='no'>id_snps</span>,
<span class='kw'>id_phenos</span> <span class='kw'>=</span> <span class='fu'>colnames</span>(<span class='no'>phenotypes</span>), <span class='kw'>kinship</span><span class='kw'>=</span><span class='no'>kinship</span>,
<span class='kw'>format</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"snptest"</span>, <span class='st'>"gemma"</span>))
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#external-formats">External formats</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

